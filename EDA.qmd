---
title: "EDA"
format: pdf
editor: visual
---

# EDA 
## Tables
### Table of Living Arrangements and what proportion of the total n each are, as well as what proportion of the total Competence Score they are
```{r}
WorkingData |> group_by(Living_Arrangement) |> summarize(n = n(), comp = sum(CompetenceScore)) |> mutate(prop_count = n/sum(n), prop_comp = comp/sum(comp))
```
There is only one entry that answered "e" so may be smart to group with another answer.

# Spread of data for Full dataset that does not include Screen Time
```{r}
FullData[,c(12,17,18)] |> lapply(summary)
```

# Spread of data for Full dataset that does not include Screen Time to compare
```{r}
WorkingSTData[,c(9,13,18,19)] |> lapply(summary)
```
At a glance, the means do not look to be incredibly different after adding in screen time which removes 33 observations

# Average scores grouped by our Class level covariate
```{r}
FullData |> group_by(ClassLvlAbbr) |> summarise(count=n(), avgcompscore = mean(CompetenceScore), avgintscore = mean(IntentionScore), avgImmscore = mean(ImmersionScore), .groups = "drop")
```

## Graphs of variables

### Boxplot of screen time
```{r}
ggplot(WorkingSTData, aes(x= AvgScreenTime)) + geom_boxplot(fill = "orchid")
```

# Histogram of Competence Score, normal curve overlayed
```{r}
ggplot(FullData, aes(x= CompetenceScore)) + geom_histogram(aes(y = after_stat(density)), bins = 35) + stat_function(fun = dnorm, args = list(mean = mean(FullData$CompetenceScore), sd = sd(FullData$CompetenceScore)),color = "red")
```


# Histogram of Intention Score, normal curve overlayed
```{r}
ggplot(FullData, aes(x= IntentionScore)) + geom_histogram(aes(y = after_stat(density)), bins= 35) + stat_function(fun = dnorm, args = list(mean = mean(FullData$IntentionScore), sd = sd(FullData$IntentionScore)),color = "red")
```

# Histogram of Immersion Score, normal curve overlayed
```{r}
ggplot(FullData, aes(x= ImmersionScore)) + geom_histogram(aes(y = after_stat(density)), bins= 35) + stat_function(fun = dnorm, args = list(mean = mean(FullData$ImmersionScore), sd = sd(FullData$ImmersionScore)),color = "red")
```


# Visualizing Sum of total competence score by Living Arrangement -> French Speaking Home
```{r}
ggplot(FullData, aes(x = factor(L_Home), y = CompetenceScore, fill = factor(ClassLvlAbbr))) +
  geom_bar(stat = "summary", fun = "mean") + scale_fill_brewer(palette = "Reds") +
  labs(x = "Lived in a French Speaking Home (0 = No, 1 = Yes)", y = "Total Competence Score") + theme_classic()
```
This bar plot shows that those that lived in a French Speaking home had a higher overall Competence score on average


#Plot of Immersion Score by Competence, colors are Class Level covariate
```{r}
ggplot(FullData, aes(x = (ImmersionScore), y = CompetenceScore, color = factor(ClassLvlAbbr))) + geom_point() + geom_abline()
```
This graph does not show a clear linear trend here

#Plot of Immersion Score by Intention, colors are Class Level covariate
```{r}
ggplot(FullData, aes(x = (ImmersionScore), y = IntentionScore, color = factor(ClassLvlAbbr))) + geom_point()
```
Similar here, no obvious linear trend

# Screen Time Plotted by Competence
```{r}
ggplot(WorkingSTData, aes(x = (AvgScreenTime), y = CompetenceScore, color = factor(ClassLvlAbbr))) + geom_point()
```



# Normality of residuals
# Model that does not include Screen Time for y = Competence Score
```{r}
Comp_model <- lm(CompetenceScore ~ ImmersionScore + L_Home + L_Dorm + L_Alone + L_Roommates + ClassLvlAbbr, data = FullData)
resid <- residuals(Comp_model)
ggplot(data.frame(resid), aes(sample = resid)) + stat_qq() + stat_qq_line()
```

# Model that does not include Screen Time for y = Intention Score
```{r}
Int_model <- lm(IntentionScore ~ ImmersionScore + L_Home + L_Dorm + L_Alone + L_Roommates + ClassLvlAbbr, data = FullData)
resid <- residuals(Int_model)
ggplot(data.frame(resid), aes(sample = resid)) + stat_qq() + stat_qq_line()
```


# Model that includes Screen Time for y = Competence Score
```{r}
STComp_model <- lm(CompetenceScore ~ ImmersionScore + L_Home + L_Dorm + L_Alone + L_Roommates + ClassLvlAbbr + AvgScreenTime, data = WorkingSTData)
resid <- residuals(STComp_model)
ggplot(data.frame(resid), aes(sample = resid)) + stat_qq() + stat_qq_line()
```

# Model that includes Screen Time for y = Intention Score
```{r}
STInt_model <- lm(CompetenceScore ~ ImmersionScore + L_Home + L_Dorm + L_Alone + L_Roommates + ClassLvlAbbr + AvgScreenTime, data = WorkingSTData)
resid <- residuals(STInt_model)
ggplot(data.frame(resid), aes(sample = resid)) + stat_qq() + stat_qq_line()
```

# Constant Variance
```{r}
ggplot(data.frame(fitted = fitted(model), resid = resid), aes(x = fitted, y = resid)) +
  geom_point()
```


